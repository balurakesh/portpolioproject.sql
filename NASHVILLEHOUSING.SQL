SELECT * FROM [PortfolioProject].[dbo].[Nashvillehousing]

SP_HELP '[PortfolioProject].[dbo].[Nashvillehousing]'

SELECT SALEDATE,CONVERT(DATE,SALEDATE) 
FROM [PortfolioProject].[dbo].[Nashvillehousing]

UPDATE [PortfolioProject].[dbo].[Nashvillehousing] SET SALEDATECON=CONVERT(DATE,SALEDATE) 

ALTER TABLE [PortfolioProject].[dbo].[Nashvillehousing] ADD SALEDATECON DATE

SELECT SALEDATE,SALEDATECON
FROM [PortfolioProject].[dbo].[Nashvillehousing]

--PROPERTY ADREES DATA
SELECT *
FROM [PortfolioProject].[dbo].[Nashvillehousing]
--WHERE PROPERTYADDRESS IS NOT NULL
ORDER BY PARCELID

SELECT A.PARCELID,A.PROPERTYADDRESS ,B.PARCELID,B.PROPERTYADDRESS,ISNULL(A.PROPERTYADDRESS,B.PROPERTYADDRESS)
FROM [PortfolioProject].[dbo].[Nashvillehousing] A
JOIN [PortfolioProject].[dbo].[Nashvillehousing] B
ON A.PARCELID=B.PARCELID
AND A.UNIQUEID<>B.UNIQUEID 
WHERE A.PROPERTYADDRESS IS NULL

UPDATE A
SET PROPERTYADDRESS=ISNULL(A.PROPERTYADDRESS,B.PROPERTYADDRESS)
FROM [PortfolioProject].[dbo].[Nashvillehousing] A
JOIN [PortfolioProject].[dbo].[Nashvillehousing] B
ON A.PARCELID=B.PARCELID
AND A.UNIQUEID<>B.UNIQUEID 
WHERE A.PROPERTYADDRESS IS NULL

--BREAKING OUT ADDRESS INTO INDIVIDUAL COLUMNS(ADDRESS,CITY,STATE)
SELECT PROPERTYADDRESS
FROM [PortfolioProject].[dbo].[Nashvillehousing]
--WHERE PROPERTYADDRESS IS NOT NULL
--ORDER BY PARCELID

SELECT SUBSTRING(PROPERTYADDRESS,1,CHARINDEX(',',PROPERTYADDRESS)-1) AS ADDRESS,
SUBSTRING(PROPERTYADDRESS,CHARINDEX(',',PROPERTYADDRESS)+1,LEN(PROPERTYADDRESS))AS ADDRESS
FROM [PortfolioProject].[dbo].[Nashvillehousing]

 UPDATE [PortfolioProject].[dbo].[Nashvillehousing] 
 SET  PROPERTYSPLITADDRESS=SUBSTRING(PROPERTYADDRESS,1,CHARINDEX(',',PROPERTYADDRESS)-1) 

ALTER TABLE [PortfolioProject].[dbo].[Nashvillehousing] ADD PROPERTYSPLITADDRESS NVARCHAR(255),
PROPERTYSPLITCITY NVARCHAR(255)
ALTER TABLE [PortfolioProject].[dbo].[Nashvillehousing] DROP COLUMN PROPRTYSPLITADDRESS 

 UPDATE [PortfolioProject].[dbo].[Nashvillehousing] 
 SET  PROPERTYSPLITCITY=SUBSTRING(PROPERTYADDRESS,CHARINDEX(',',PROPERTYADDRESS)+1,LEN(PROPERTYADDRESS))

 SELECT * FROM [PortfolioProject].[dbo].[Nashvillehousing]

 --OWNER ADDRESS
 SELECT
 PARSENAME(REPLACE(OWNERADDRESS,',','.'),3),
 PARSENAME(REPLACE(OWNERADDRESS,',','.'),2),
 PARSENAME(REPLACE(OWNERADDRESS,',','.'),1)
 FROM [PortfolioProject].[dbo].[Nashvillehousing]

 ALTER TABLE [PortfolioProject].[dbo].[Nashvillehousing] ADD OWNWERSPLITADDRESS NVARCHAR(255),
 OWNWERSPLITCITY NVARCHAR(255),OWNWERSPLITSTATE NVARCHAR(255)

 UPDATE [PortfolioProject].[dbo].[Nashvillehousing] 
 SET   OWNWERSPLITADDRESS=PARSENAME(REPLACE(OWNERADDRESS,',','.'),3)
 UPDATE [PortfolioProject].[dbo].[Nashvillehousing] 
 SET   OWNWERSPLITCITY=PARSENAME(REPLACE(OWNERADDRESS,',','.'),2)
 UPDATE [PortfolioProject].[dbo].[Nashvillehousing] 
 SET   OWNWERSPLITSTATE=PARSENAME(REPLACE(OWNERADDRESS,',','.'),1)

 SELECT * FROM [PortfolioProject].[dbo].[Nashvillehousing]

 --CHANGE Y AND N TO YES AND NO IN SOLD AS VACANT FIELD
 SELECT DISTINCT(SOLDASVACANT),COUNT(SOLDASVACANT)
  FROM [PortfolioProject].[dbo].[Nashvillehousing]
  GROUP BY SOLDASVACANT
  ORDER BY 2

  SELECT SOLDASVACANT,
  CASE WHEN SOLDASVACANT='Y' THEN 'YES'
       WHEN SOLDASVACANT='N' THEN 'NO'
       ELSE SOLDASVACANT
       END
  FROM [PortfolioProject].[dbo].[Nashvillehousing]

  UPDATE [PortfolioProject].[dbo].[Nashvillehousing] 
  SET SOLDASVACANT=CASE WHEN SOLDASVACANT='Y' THEN 'YES'
       WHEN SOLDASVACANT='N' THEN 'NO'
       ELSE SOLDASVACANT
       END

--REMOVING DUPLICATES
SELECT *,
ROW_NUMBER()OVER(PARTITION BY PARCELID,PROPERTYADDRESS,SALEPRICE,SALEDATE,LEGALREFERENCE ORDER BY UNIQUEID) ROWNUM
FROM [PortfolioProject].[dbo].[Nashvillehousing] 
--ORDER BY PARCELID

 --DELETE UNUSED DATA
 ALTER TABLE [PortfolioProject].[dbo].[Nashvillehousing] 
 DROP COLUMN OWNERADDRESS,TAXDISTRICT,PROPERTYADDRESS

 SELECT * FROM [PortfolioProject].[dbo].[Nashvillehousing] 

 ALTER TABLE [PortfolioProject].[dbo].[Nashvillehousing] 
 DROP COLUMN SALEDATE





